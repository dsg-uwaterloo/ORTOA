# ORTOA-tee CMake

The ORTOA-tee project builds 4 executables and a handful of shared libraries (`.so` files). In particular, the executables built are:

- `client`
- `ortoa-host`
- `ortoa-enc`
- `ortoa-enc.signed`

These executables are then used to run the ORTOA-tee program.

## Building & installing the project

Using the provided script library:

```bash
ORTOA/ $ ortoa-cbi # Configure, build & install the C++ project
```

To manually build and install the project:

```bash
# Create build directory
ORTOA/ $ mkdir build && cd build

# Configure, build & install
ORTOA/build/ $ cmake ..
ORTOA/build/ $ make
ORTOA/build/ $ make install
```

## What do each of those do?

### 1. Configure the software

The `ortoa-configure` script or `cmake ..` step is responsible for getting ready to build the software on your specific system. It aims to make sure that all of the dependencies for the rest of the build and install process are available.

### 2. Build the software

Once `configure` has done its job, we can invoke `ortoa-build` or `make` to build the software. This runs a series of tasks defined in the Makefiles generated by the `configure` stage to build the finished program from its source code.

### 3. Install the software

Now that the software is built and ready to run, the files can be copied to their final destinations. The `ortoa-install` or `make install` commands will copy the built program and its libraries to the correct locations.

The ORTOA-tee project installs the software in the `${REPO_ROOT}/install/` directory rather than copying it to a directory on the `PATH`. As a result, developers may have to export the following variable when running the project. This can be added to a `bashrc` or similar file, or can be run in the shell before running the project.

```sh
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:<REPO_ROOT>/install/lib
```

## Fetch Content

We include certain components using [`FetchContent`](https://cmake.org/cmake/help/latest/module/FetchContent.html). Our use cases add the components' source code in the `configure` stage, which is then built in the `build` stage. In particular, we use this mechanism to bring in a logging library (`spdlog`) and a command line argument parsing library (`argparse`).
